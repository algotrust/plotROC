---
title: "ROC Curves using ggplot + d3.js"
author: "Michael Sachs"
date: "`r Sys.Date()`"
output: 
  rmarkdown::html_vignette:
      self_contained: false
vignette: >
  %\VignetteIndexEntry{proof}
  %\VignetteEngine{knitr::rmarkdown}
  %\usepackage[utf8]{inputenc}
---

# Interactive SVG ROC Curves
After installing, run the interactive Shiny app
```{r shiny, eval = FALSE}
shiny_plotROC()
```


## Hover over to view the cutoff values

```{r test-a, fig.keep='none', results = 'asis', echo = TRUE, fig.width=6, fig.height=6}
library(plotROC)
D.ex <- rbinom(100, 1, .5)

rocdata <- calculate_roc(rnorm(100, mean = D.ex), D.ex)

myrocplot <- ggroc(rocdata, label = "Example")

cat(export_interactive_roc(myrocplot, cutoffs = rocdata$c, font.size = "12px", prefix = "a"))
```

That is an svg element. Try zooming in!

## Generate an interactive plot to view in Rstudio viewer or web browser

```{r inter, eval = FALSE}
plot_interactive_roc(rocdata)
```


# Themes and annotations

```{r test-b, fig.keep='none', results = 'asis', echo = TRUE, fig.width=6, fig.height=6}
library(ggthemes)
myplot2 <- myrocplot + theme_igray()

cat(export_interactive_roc(myplot2, cutoffs = rocdata$c, font.size = "12px", prefix = "b"))
```


# For using in print

```{r print, fig.width = 6, fig.height = 6}
plot_journal_roc(myrocplot, rocdata)
```

# Themes work in print too, but I don't recommend colors

```{r print2, fig.width = 6, fig.height = 6}
plot_journal_roc(myrocplot, rocdata) + theme_igray() + ggtitle("My awesome new biomarker")
```


# Multiple ROC Curves

```{r multi, fig.width = 6, fig.height = 6}
D.ex <- rbinom(100, 1, .5)

fakedata <- data.frame(M1 = rnorm(100, mean = D.ex), M2 = rnorm(100, mean = D.ex, sd = .4), M3 = runif(100), D = D.ex)
datalist <- calculate_multi_roc(fakedata, c("M1", "M2", "M3"), "D")

rocplot <- multi_ggroc(datalist)
plot_journal_roc(rocplot, datalist)
```

```{r test-multi, fig.keep='none', results = 'asis', echo = TRUE, fig.width=6, fig.height=6}
cat(export_interactive_roc(rocplot, cutoffs = lapply(datalist, function(d) d$c), font.size = "12px", prefix = "bmulti"))
```

## Labels
```{r multi2, fig.width = 6, fig.height = 6}
D.ex <- rbinom(100, 1, .5)

fakedata <- data.frame(M1 = rnorm(100, mean = D.ex), M2 = rnorm(100, mean = D.ex, sd = .4), M3 = runif(100), D = D.ex)
datalist <- calculate_multi_roc(fakedata, c("M1", "M2", "M3"), "D")

rocplot <- multi_ggroc(datalist, label = c("M1", "M2", "M3"))
plot_journal_roc(rocplot, datalist)
```



# Acknowledgements

This package would not be possible without the following:

  - [ggplot2](http://ggplot2.org/)
  - [gridSVG](http://sjp.co.nz/projects/gridsvg/)
  - [d3.js](http://d3js.org)
  




